@model LibraryWebApp.Models.ViewModels.IndexViewModel
@{
    ViewBag.Title = "IndexUser";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2 id="a">Users section</h2>

<p class="text-success">@ViewBag.StatusMessage</p>
<div class="container">
    <h4 id="b">Your personal data</h4>
    <hr />
    <div class="row">
        <div class="col-xs-6 col-sm-8 col-md-10 col-lg-10">
            <dl class="dl-horizontal">
                <dt class="dt">User: </dt>
                <dd id="username" class="dd">@User.Identity.Name</dd>
                <dt class="dt">User Role:</dt>
                <dd class="dd">
                    === User ===
                </dd>
            </dl>
        </div>
        <div class="col-xs-6 col-sm-4 col-md-2 col-lg-2">
            <button id="btnclick" class="btn btn-primary" type="button">Become a member</button>
        </div>
    </div>
    <ul class="nav nav-tabs">
        <li class="active">
            <a data-toggle="tab" href="#changeDetails">Personal details</a>
        </li>
        <li>
            <a data-toggle="tab" href="#purchasedBooks">Purchased Books</a>
        </li>
    </ul>

    <div class="tab-content">
        <div id="changeDetails" class="tab-pane fade in active">
            <br />
            @Html.ActionLink("Change password", "ChangePassword", "Manage", null, new { @class = "btn btn-primary" })
            @Html.ActionLink("Edit details", "EditDetails", "Manage", null, new { @class = "btn btn-primary" })
            <br />
            <br />

            <div class="form-horizontal">
                <div class="form-group">
                    @Html.LabelFor(m => m.User.FirstName, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.User.FirstName, new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.User.LastName, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.User.LastName, new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.User.Age, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.User.Age, new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.User.Gender, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBox("Gender", Model.User.Gender ? "Male" : "Female", new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.User.Address, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.User.Address, new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.User.City, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.User.City, new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.User.Country, new { @class = "col-md-2 control-label", style = "cursor: pointer;" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.User.Country, new { @class = "form-control", @readonly = true, style = "cursor: not-allowed;" })
                    </div>
                </div>
            </div>
        </div>
        <div id="purchasedBooks" class="tab-pane fade in">
            <br />
            <div class="table-responsive">
                <table id="table" class="table table-bordered table-hover table-striped">
                    <thead>
                        <tr>
                            <th>
                                Image
                            </th>
                            <th>
                                Title
                            </th>
                            <th>
                                Genre
                            </th>
                            <th>
                                Pages
                            </th>
                            <th>Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.PurchasedBooks)
                        {
                            <tr>
                                <td>
                                    <img src="@item.CoverURL" style="max-width: 200px; max-height: 200px" />
                                </td>
                                <td>
                                    @Html.ActionLink(item.Title, "Details", "Books", new { id = item.Id }, new { })
                                </td>
                                <td>
                                    @item.Genre.Name
                                </td>
                                <td>
                                    @item.Pages
                                </td>
                                <td class="book-price">
                                    @item.Price
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div id="divpopup">
    <p>
        Do you accept following rules to become a member:
        <ul>
            <li>sdfdsffsdsdffsdfds</li>
            <li>asddsadsadsasdasdads</li>
            <li>asddddddddddsaasd</li>
        </ul>
    </p>
</div>

@section styles {
    <link rel="stylesheet" type="text/css" href="@Href("~/Content/IndexUserCss.css")" />
    <link type="text/css" rel="stylesheet" href="http://code.jquery.com/ui/1.12.1/themes/redmond/jquery-ui.css" />
}

@section scripts {
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            var dialog = $("#divpopup").dialog({
                autoOpen: false,
                modal: true,
                resizable: false,
                draggable: false,
                title: "Become member",
                width: 400,
                height: 350,
                buttons: {
                    Accept:
                        function () {
                            url = "/Account/AddToRoleMember?username=" + $("#username").html();
                            window.location = url;
                            dialog.dialog("close");
                        },
                    Close:
                        function () {
                            dialog.dialog("close");
                        }
                }
            });

            $("#btnclick").click(function () {
                dialog.dialog("open");
            });

            $("#table").DataTable();

            $(".book-price").each(function () {
                var price = $(this).text();
                $(this).text(new Intl.NumberFormat('en-US', { style: "currency", currency: "USD" })
                    .format(price));
            });
        });
    </script>
}