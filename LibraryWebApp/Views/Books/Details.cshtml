@model LibraryWebApp.Models.BookDetailsViewModel

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



@Html.Hidden("IsAuthenticated", Request.IsAuthenticated)

<div id="headerDetails">
    <h2 id="ht">Book Details</h2>
</div>

<div id="container">

    <div id="editions">

        <p id="e"><strong>@Model.Book.Quantity</strong> editions of  <strong>@Model.Book.Title</strong> found in the catalog. <a href="/Books/Edit/@Model.Book.Id">Add another one?</a></p>

    </div>

    <div id="editBtn">
        <a href="/Books/Edit/@Model.Book.Id"><button type="submit" class="btn btn-primary pull-right " style="margin: -45px 55px 15px 80px;">Edit</button></a>
    </div>

    <p><img style="float: left; margin: 15px 15px 15px 80px;" src="@Model.Book.CoverURL" width="200" /> <p class="embed-responsive-item">
        <strong>@Model.Book.Title</strong>

        @foreach (var author in Model.Book.Authors)
        {
        <p>by <a href="/Authors/Details/@author.Id">@author.Name</a></p>
    }
        <p id="md">Published in <a href="">@Model.Book.PublishPlace</a></p>
        <br />
        <br />
        <br />
        <p><strong>The @Model.Book.Genre.Name Object</strong></p>

        <p>Publish date: @Model.Book.PublishDate</p>
        <p>Number of pages: @Model.Book.Pages</p>

        <br style="clear: both;" />



        <div class="warper pull-right" style=" margin: -310px 55px 15px 0px; height: 300px;">

            <nav id="sidebar">
                <div id="btn">

                    @if (Model.Book.Quantity > 0)
                    {

                        <button type="button" class="btn btn-primary js-add-to-cart center-block" data-book-id="@Model.Book.Id" style=" margin-top: 10px;">Add to cart</button>
                    }
                    else
                    {
                        <button type="button" class="btn btn-primary center" title="Out of stock" disabled>Add to cart</button>
                    }


                </div>
                <hr />


                <p class="text-center"><strong>Prefer the @Model.Book.Genre.Name book?</strong></p>
                <p class="text-center"><a href="">Check nearby libaries</a></p>

                <hr />

                <p class="text-center"><strong>Share this book</strong></p>

                <div id="social" class="text-center">
                    <a href="http://www.facebook.com/"> <img src="/images/facebook.png"></a>
                    <a href="http://www.linkedin.com/"> <img src="/images/linkedin.png"></a>
                    <a href="http://twitter.com/"> <img src="/images/twitter.png"></a>
                </div>


            </nav>

            <div id="content">


            </div>
        </div>



        <p id="recomended" class="left" style=" margin: 80px 35px 0px 75px;">More books from @Model.Book.Genre.Name genre </p>


        <div id="myCarousel" class="carousel slide">
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                    <img src="@Model.Book.CoverURL" class="center-block" />

                </div>

                <div class="item">

                    @foreach (var book in Model.Books)
                    {
                        <a href="/Books/Details/@book.Id"><img src="@book.CoverURL" class="center-block" /></a><link />
                    }


                </div>
            </div>
            <a class="left carousel-control" href="#myCarousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>
            <a class="right carousel-control" href="#myCarousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
        </div>

        <a href="/Books/Index"><button type="submit" class="btn btn-primary" style=" margin: 20px 15px 0px 75px;">Back to list</button></a>

</div>


<p>

    @section scripts {

        <link rel="stylesheet" type="text/css" href="@Href("~/Content/BookDetailsCss.css")" />
        <link type="text/css" rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/redmond/jquery-ui.css" />
        <script type="text/javascript">
            var bookCount = @Model.Book.Quantity;
            var bookId = @Model.Book.Id;

            $(document).ready(function() {
                $(".js-add-to-cart").on("click",
                    function() {
                        if ($("#IsAuthenticated").attr("value") === "False") {
                            document.location = "/Account/Login?ReturnUrl=%2FBooks/Details/" + bookId;
                            return;
                        }

                        var button = $(this);
                        bookId = button.attr("data-book-id");

                        $.post("/ShoppingCart/AddToCart",
                            { "id": bookId },
                            function(response) {
                                console.log(response);
                                $("#cart-items-count").text(response.CartCount);
                                $(".message").text("Go to checkout");
                            });
                        bookCount--;

                        if (bookCount === 0) {
                            $(".js-add-to-cart").prop("disabled", true);
                            $(".js-add-to-cart").prop("title", "Out of stock");
                        }
                    });
            });
        </script>

        <script type="text/javascript">
            $(document).ready(function () {
                $('.carousel').carousel({
                    interval: 4200,
                    animation: 3000,
                    auto: 10,
                    scroll: -1,
                    visible: 3,
                    wrap: 'circular',
                    setupCallback: scrollCheck,


                })
            });
        </script>


    }

</p>